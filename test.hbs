<!DOCTYPE html>
<html>
<head>
    <title>Platform Metrics</title>
    <link rel="stylesheet" href="/css/modal.css">
    <link rel="stylesheet" href="/css/datatables.css">
    <script src="/js/datatables.js"></script>
</head>
<body>
    <h4 class="partialHeader" id="awsSearchHeader">Platform Metrics</h4>
    
    <table id="metricsTable" border="1">
        <thead>
            <tr>
                <th>Account</th>
                <th>Date</th>
                <th>Item</th>
                <th>Item Type</th>
                <th>Platform</th>
                <th>Reason</th>
                <th>Status</th>
                <th>ID</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- Dữ liệu sẽ được thêm vào đây -->
        </tbody>
    </table>

    <script>
        async function fetch_data() {
            //Define fetch query variables
            var endpoint = "platformmetrics";
            var query = "";
            
            const response = await fetch('/' + endpoint + query);
            const obj = await response.json();
            
            console.log("fetched data", obj);
            return obj;
        }

        function loadTable(data) {
            const tbody = document.getElementById('tableBody');
            tbody.innerHTML = ''; // Xóa nội dung cũ
            
            // Lặp qua từng item trong array
            data.forEach(item => {
                const row = document.createElement('tr');
                
                row.innerHTML = `
                    <td>${item.account}</td>
                    <td>${item.date}</td>
                    <td>${item.item}</td>
                    <td>${item.item_type}</td>
                    <td>${item.platform}</td>
                    <td>${item.reason}</td>
                    <td>${item.status}</td>
                    <td>${item._id}</td>
                `;
                
                tbody.appendChild(row);
            });
        }

        // Gọi hàm khi trang load
        fetch_data().then(data => {
            console.log("result", data);
            loadTable(data);
        });
        function getStatusColor(status) {
    const statusLower = status.toLowerCase();
    if (statusLower === 'healthy') {
        return 'green';
    } else if (statusLower === 'unhealthy') {
        return 'red';
    } else {
        return 'black'; // màu mặc định
    }
}
    </script>
</body>
</html>
